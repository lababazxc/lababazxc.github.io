---
title: Serivce Mesh简读
date: 2021-12-27 20:52:50
tags:
---
#### 前言
在MTSC2021上，字节分享了关于广告系统的质量保障实践。其中提到的byte mesh是借鉴了Service Mesh的思想。因此对原文做一个简读。

#### 内容
文章主要阐述的核心问题在于：分布式系统简单易用，但是也导致了很多问题。例如组织散乱、逻辑重复和数据传输。然后通过服务间通信的发展历程来说明每一次迭代的优缺点，最终引出Service Mesh是如何解决相关问题的。本文也通过此方法进行回顾。
**网络发展初期**
---
计算机发展初期，几台计算机间的通信拓扑如下图
<img src="https://s2.loli.net/2021/12/29/CfLiRvrQb5kw16a.png" width="50%" height="50%">
如果往图中加入网络通信模块，就是最简单的、完整的服务通信图。
<img src="https://s2.loli.net/2021/12/29/bpFUgh6KMEN29wj.png" width="50%" height="50%">
当计算机发展到19世纪50年代，为了保障连接稳定性，需要解决在同一网路中发现彼此、处理多个同时连接、允许机器在非直连的情况下通信、跨网络路由数据包，加密流量等问题。同时为了保证A、B服务能够处理交互的数据流，需要加入flow control（流量控制）和business logic（业务逻辑）。在这个流量控制模型中（如下图），服务需要自己处理业务逻辑、数据包逻辑。
<img src="https://s2.loli.net/2021/12/29/XMmlVeZ2hoL5pAg.png" width="50%" height="50%">
随着技术的发展，产生了很多标准如TCP/IP协议，使得数据包逻辑可以从代码逻辑中解耦出来，让网络协议本身来解决流量拥塞问题。下图这个模型被广泛的使用在各个场景中。
<img src="https://s2.loli.net/2021/12/29/iADS31JN7WKcxps.png" width="50%" height="50%">

**微服务初见**
----
随着时间的发展，网络系统也发展出诸如细粒度的分布式代理、面向对象的SOA架构。分布式架构带来极致的收益的同时，也带来了一些问题
Peter Deutsch提出了分布式计算的8个谬误：
1. 网络可靠
2. 零延迟
3. 带宽无限
4. 网络安全
5. 网络拓扑不改变
6. 只有一个管理员
7. 传输成本为零
8. 网络是同质的

既然存在这些误解，意味着仍需工程师来解决这方面的问题。

那么在更复杂的微服务当中也需要处理问题：
1. 快速的配置计算资源
2. 基础监控
3. 快速部署
4. 配置易存储
5. 易获得边缘节点
6. 认证/授权
7. 标准化RPC是

TCP/IP协议经过多年的发展仍是强大的网络通信协议栈，为解决上述问题引入了更复杂的架构/需求，仍需工程师来满足。例如：例如：service discovery，circuit breaker等

待续..